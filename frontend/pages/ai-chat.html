<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Fraud Analyst - Chat Interface</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Custom Tailwind Configuration -->
    <script src="../js/tailwind-config.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/main.css" />
  </head>
  <body class="bg-gray-50 font-inter text-gray-900 min-h-screen">
    <header
      class="bg-gradient-to-r from-blue-900 via-blue-800 to-indigo-800 shadow-lg backdrop-blur-sm border-b border-white/10"
    >
      <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <div class="flex items-center">
            <a href="/" class="flex items-center space-x-3 hover:opacity-90 transition-opacity">
              <i class="fas fa-shield-alt text-white text-2xl"></i>
              <span class="text-white text-xl font-bold">Fraud Detection System</span>
            </a>
          </div>
          <div class="flex items-center space-x-2">
            <a
              href="/dashboard"
              class="relative px-4 py-2 rounded-md text-white/80 font-medium transition-all duration-300 hover:text-white hover:bg-white/10"
            >
              <i class="fas fa-home mr-2"></i>Dashboard
            </a>
            <a
              href="/ai-chat"
              class="relative px-4 py-2 rounded-md text-white font-medium transition-all duration-300 bg-white/10 border-b-2 border-white"
              aria-current="page"
            >
              <i class="fas fa-robot mr-2"></i>AI Chat
            </a>
            <button
              onclick="logout()"
              class="relative px-4 py-2 rounded-md text-white/80 font-medium transition-all duration-300 hover:text-white hover:bg-red-500/20 border border-transparent hover:border-red-400/30"
            >
              <i class="fas fa-sign-out-alt mr-2"></i>Logout
            </button>
          </div>
        </div>
      </nav>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 lg:gap-8">
        <div class="lg:col-span-1 order-2 lg:order-1">
          <!-- SECTION: Sidebar/Quick Actions -->
          <section aria-label="Quick Actions" class="space-y-6">
            <!-- SECTION: Pilihan Batch Data untuk Analisis -->
            <section class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
              <div class="bg-gradient-to-r from-fraud-primary to-fraud-secondary text-white p-4">
                <h5 class="font-semibold flex items-center text-lg">
                  <i class="fas fa-database mr-2"></i>
                  Select Data for Analysis
                </h5>
              </div>
              <div class="p-4 space-y-4">
                <div>
                  <label for="batchSelector" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-database mr-2 text-fraud-primary"></i>Dataset Batch
                  </label>
                  <select
                    id="batchSelector"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fraud-primary focus:border-transparent bg-white shadow-sm"
                    aria-describedby="batch-selector-help"
                  >
                    <option value="">Loading batches...</option>
                  </select>
                  <div
                    id="batch-selector-help"
                    class="text-fraud-gray text-sm mt-2 flex items-start"
                  >
                    <i class="fas fa-info-circle mr-1 mt-0.5 text-fraud-primary"></i>
                    <span>Select uploaded batch data for AI analysis</span>
                  </div>
                </div>
                <div>
                  <button
                    id="deepAnalysisBtn"
                    class="w-full bg-gradient-to-r from-fraud-primary to-fraud-secondary text-white py-3 rounded-lg font-medium hover:from-fraud-secondary hover:to-fraud-primary transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg focus:ring-2 focus:ring-fraud-primary focus:ring-offset-2"
                    disabled
                    aria-describedby="deep-analysis-help"
                  >
                    <i class="fas fa-brain mr-2"></i>
                    Automatic Deep Analysis
                  </button>
                </div>
                <div class="text-center">
                  <small id="deep-analysis-help" class="text-fraud-gray flex items-start text-xs">
                    <i class="fas fa-lightbulb mr-1 mt-0.5 text-fraud-warning"></i>
                    <span
                      >Automatic analysis will provide comprehensive insights about your data</span
                    >
                  </small>
                </div>
              </div>
            </section>

            <!-- SECTION: Quick Actions Card -->
            <section class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
              <div class="bg-gradient-to-r from-fraud-teal to-green-600 text-white p-4">
                <h5 class="font-semibold flex items-center text-lg">
                  <i class="fas fa-bolt mr-2"></i>
                  Quick Questions
                </h5>
              </div>
              <div class="p-4">
                <div class="space-y-3">
                  <button
                    class="w-full text-left border border-blue-200 text-blue-700 py-3 px-4 rounded-lg text-sm hover:bg-blue-50 hover:border-blue-300 focus:bg-blue-50 focus:border-blue-300 focus:ring-2 focus:ring-blue-200 transition-all duration-200 quick-btn group"
                    data-question="Berapa persentase transaksi anomali yang terdeteksi?"
                    aria-label="Ask about anomaly statistics"
                  >
                    <i class="fas fa-chart-pie mr-3 group-hover:text-blue-600"></i>Statistik Anomali
                  </button>
                  <button
                    class="w-full text-left border border-amber-200 text-amber-700 py-3 px-4 rounded-lg text-sm hover:bg-amber-50 hover:border-amber-300 focus:bg-amber-50 focus:border-amber-300 focus:ring-2 focus:ring-amber-200 transition-all duration-200 quick-btn group"
                    data-question="Merchant mana yang paling berisiko?"
                    aria-label="Ask about risky merchants"
                  >
                    <i class="fas fa-store mr-3 group-hover:text-amber-600"></i>Merchant Berisiko
                  </button>
                  <button
                    class="w-full text-left border border-teal-200 text-teal-700 py-3 px-4 rounded-lg text-sm hover:bg-teal-50 hover:border-teal-300 focus:bg-teal-50 focus:border-teal-300 focus:ring-2 focus:ring-teal-200 transition-all duration-200 quick-btn group"
                    data-question="Pada jam berapa anomali paling sering terjadi?"
                    aria-label="Ask about time patterns of anomalies"
                  >
                    <i class="fas fa-clock mr-3 group-hover:text-teal-600"></i>Pola Waktu
                  </button>
                  <button
                    class="w-full text-left border border-green-200 text-green-700 py-3 px-4 rounded-lg text-sm hover:bg-green-50 hover:border-green-300 focus:bg-green-50 focus:border-green-300 focus:ring-2 focus:ring-green-200 transition-all duration-200 quick-btn group"
                    data-question="Apa rekomendasi tindakan untuk mencegah fraud?"
                    aria-label="Ask for fraud prevention recommendations"
                  >
                    <i class="fas fa-shield-alt mr-3 group-hover:text-green-600"></i>Rekomendasi
                    Pencegahan
                  </button>
                  <button
                    class="w-full text-left border border-red-200 text-red-700 py-3 px-4 rounded-lg text-sm hover:bg-red-50 hover:border-red-300 focus:bg-red-50 focus:border-red-300 focus:ring-2 focus:ring-red-200 transition-all duration-200 quick-btn group"
                    data-question="Lokasi mana yang memiliki transaksi paling mencurigakan?"
                    aria-label="Ask about location analysis for suspicious transactions"
                  >
                    <i class="fas fa-map-marker-alt mr-3 group-hover:text-red-600"></i>Analisis
                    Lokasi
                  </button>
                  <button
                    class="w-full text-left border border-gray-200 text-gray-700 py-3 px-4 rounded-lg text-sm hover:bg-gray-50 hover:border-gray-300 focus:bg-gray-50 focus:border-gray-300 focus:ring-2 focus:ring-gray-200 transition-all duration-200 quick-btn group"
                    data-question="Bagaimana perbandingan nilai transaksi normal vs anomali?"
                    aria-label="Ask about value comparison between normal and anomalous transactions"
                  >
                    <i class="fas fa-balance-scale mr-3 group-hover:text-gray-600"></i>Perbandingan
                    Nilai
                  </button>
                </div>
              </div>
            </section>
          </section>
        </div>
        <div class="lg:col-span-3 order-1 lg:order-2">
          <!-- Chat Card -->
          <section aria-label="AI Chat" class="h-full min-h-[600px] lg:min-h-[700px]">
            <div class="bg-white rounded-xl shadow-lg border border-gray-100 h-full flex flex-col">
              <div
                class="bg-gradient-to-r from-fraud-success to-green-600 text-white p-4 flex justify-between items-center"
              >
                <h5 class="font-semibold flex items-center text-lg">
                  <i class="fas fa-comment-dots mr-2"></i>
                  Consult with AI Risk Analyst
                </h5>
                <button
                  id="clearChatBtn"
                  class="text-white border border-white px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-white hover:text-fraud-success focus:bg-white focus:text-fraud-success focus:ring-2 focus:ring-white transition-all duration-200 shadow-sm"
                  title="Clear all chat messages"
                  aria-label="Clear all chat messages"
                >
                  <i class="fas fa-trash mr-1"></i>Clear Chat
                </button>
              </div>

              <!-- Chat Messages Container -->
              <div
                class="flex-1 p-4 overflow-y-auto bg-gray-50 min-h-[400px] lg:min-h-[500px]"
                id="chatContainer"
              >
                <!-- Loading Skeleton -->
                <div id="chatSkeleton" class="hidden">
                  <div class="flex mb-4">
                    <div class="flex-1 space-y-2">
                      <div class="bg-gray-300 h-4 rounded w-3/4 animate-pulse"></div>
                      <div class="bg-gray-300 h-4 rounded w-1/2 animate-pulse"></div>
                      <div class="bg-gray-300 h-4 rounded w-2/3 animate-pulse"></div>
                    </div>
                  </div>
                </div>

                <!-- Welcome Message -->
                <div
                  class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4 mb-4 shadow-sm"
                >
                  <div class="flex items-start space-x-3">
                    <i class="fas fa-info-circle text-blue-600 mt-1 text-lg"></i>
                    <div class="text-blue-800">
                      <strong class="text-blue-900">Welcome to AI Fraud Analyst!</strong>
                      <p class="mt-1">
                        Please select a dataset batch first to start analysis with AI.
                      </p>
                      <div class="mt-3 text-sm space-x-2">
                        <kbd class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-mono"
                          >Ctrl</kbd
                        >
                        +
                        <kbd class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-mono"
                          >Enter</kbd
                        >
                        <span class="text-blue-700">to send message</span> |
                        <kbd class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-mono"
                          >Ctrl</kbd
                        >
                        +
                        <kbd class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-mono"
                          >K</kbd
                        >
                        <span class="text-blue-700">to focus input</span>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Sample Charts Placeholder -->
                <div id="analyticsPreview" class="hidden">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div
                      class="bg-white border border-gray-200 rounded-lg p-4 text-center shadow-sm"
                    >
                      <canvas id="anomalyChart" width="200" height="100"></canvas>
                      <small class="text-gray-600 block mt-2 font-medium"
                        >Anomaly Distribution</small
                      >
                    </div>
                    <div
                      class="bg-white border border-gray-200 rounded-lg p-4 text-center shadow-sm"
                    >
                      <canvas id="timelineChart" width="200" height="100"></canvas>
                      <small class="text-gray-600 block mt-2 font-medium"
                        >Transaction Timeline</small
                      >
                    </div>
                  </div>
                </div>
              </div>

              <!-- Chat Input -->
              <div class="border-t border-gray-200 p-4 bg-white">
                <form id="chatForm">
                  <div class="flex space-x-3">
                    <input
                      type="text"
                      id="chatInput"
                      class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fraud-primary focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed shadow-sm"
                      placeholder="Ask about fraud patterns, recommendations, or other insights..."
                      disabled
                      autocomplete="off"
                      aria-describedby="chat-input-help"
                    />
                    <div id="chat-input-help" class="sr-only">
                      Type your question about fraud detection analysis and press Enter to send
                    </div>
                    <button
                      type="submit"
                      id="chatSubmit"
                      class="bg-gradient-to-r from-fraud-primary to-fraud-secondary text-white px-6 py-3 rounded-lg hover:from-fraud-secondary hover:to-fraud-primary transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg"
                      disabled
                    >
                      <i class="fas fa-paper-plane"></i>
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </section>
        </div>
      </div>
    </main>

    <!-- SECTION: Footer -->
    <footer class="bg-gradient-to-r from-blue-900 via-blue-800 to-indigo-800 text-white py-8 mt-12">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <div class="bg-white bg-opacity-10 rounded-lg p-6 backdrop-blur-sm border border-white/20">
          <div class="flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="text-center md:text-left">
              <div class="flex items-center justify-center md:justify-start space-x-2 mb-2">
                <i class="fas fa-shield-alt text-lg"></i>
                <span class="font-semibold">Fraud Detection System</span>
              </div>
              <small class="text-blue-100">Powered by Advanced AI & Machine Learning</small>
            </div>
            <div class="flex flex-col sm:flex-row items-center gap-3">
              <span
                class="bg-blue-700/80 text-white px-4 py-2 rounded-lg text-sm font-medium border border-blue-600/50"
              >
                <i class="fas fa-trophy mr-2"></i>
                Hackathon BI 2025
              </span>
              <small class="text-blue-200"> &copy; 2025 All rights reserved. </small>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Toast Notifications Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2">
      <!-- Toasts will be dynamically inserted here -->
    </div>

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
    <script src="../js/config.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/ai-chat.js"></script>
  </body>
</html>
